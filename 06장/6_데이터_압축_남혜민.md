# 페이지 압축

MySQL 서버가 디스크 저장 시점에 데이터 페이지 압축해 저장, 디스크에서 데이터 페이지 읽어올 때 압축 해제
버퍼 풀에 데이터 페이지가 한 벅 적재되면 InnoDB 스토리지 엔진은 압축이 해제된 상태로만 데이터 페이지를 관리

페이지 압축 작동 방식

1. 16kb 페이지 압축
2. MySQL 서버 디스크에 압축된 결과 7kb 기록
3. 디스크에 데이터 기록 후 9kb 공간에 펀치홀(Punch-hole) 생성
4. 파일 시스템은 7kb 만 남기고 나머지 디스크 9kb 공간은 운영체제로 반납

펀치홀 문제로 실제 많이 사용되지 않음

# 테이블 압축

운영체제나 하드웨어 제약 없이 사용, 활용도 높음

단점

- 버퍼풀 공간 활용률 낮음
- 쿼리 처리 성능이 낮음
- 빈번한 데이터 변경시 압축률 떨어짐

### 압축 테이블 생성

원본 데이터 페이지의 압축 결과가 목표 크기보다 작거나 같을 때까지 반복저으로 페이지 스플릿

압축 알고리즘은 CPU 많이 소모됨

InnoDB 스토리지 엔진은 압축된 테이블 데이터 페이지를 버퍼풀에 적재하면 압축상태, 압축 해제 상태 2개 버전 관리
